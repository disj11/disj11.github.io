<!doctype html><html lang=ko><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XD9VVSGMKV"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XD9VVSGMKV")}</script><title>CSV 파일을 맥용 엑셀에서 볼 때 한글이 깨지는 문제 ::</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=" 스프링 부트와 코틀린을 사용한 CSV 파일 다운로드 트러블슈팅 # 스프링 부트와 코틀린을 사용하여 CSV 파일 다운로드 기능을 구현하는 과정에서 발생한 여러 문제와 그 해결 방법에 대해 설명하겠습니다.
"><meta name=keywords content="개발 블로그,개발블로그"><meta name=robots content="noodp"><link rel=canonical href=https://disj11.github.io/troubleshooting-for-csv-file-download/><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://disj11.github.io/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://disj11.github.io/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://disj11.github.io/img/favicon.png><link href=/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="CSV 파일을 맥용 엑셀에서 볼 때 한글이 깨지는 문제"><meta name=twitter:description content="CSV 파일 다운로드 기능을 구현할 때 발생하는 주요 문제들과 그 해결 방법을 다룹니다. 주요 내용으로는 한글 깨짐 문제 해결을 위한 BOM 문자 추가, 프론트엔드에서의 다운로드 문제 해결을 위한 'blob' 타입 지정, CSV 형식 오류 해결을 위한 특수 문자 처리 방법 등이 포함됩니다."><meta property="og:url" content="https://disj11.github.io/troubleshooting-for-csv-file-download/"><meta property="og:site_name" content="Life Log"><meta property="og:title" content="CSV 파일을 맥용 엑셀에서 볼 때 한글이 깨지는 문제"><meta property="og:description" content="CSV 파일 다운로드 기능을 구현할 때 발생하는 주요 문제들과 그 해결 방법을 다룹니다. 주요 내용으로는 한글 깨짐 문제 해결을 위한 BOM 문자 추가, 프론트엔드에서의 다운로드 문제 해결을 위한 'blob' 타입 지정, CSV 형식 오류 해결을 위한 특수 문자 처리 방법 등이 포함됩니다."><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-18T13:47:47+09:00"><meta property="article:modified_time" content="2025-01-18T13:47:47+09:00"><meta property="article:tag" content="TIL"><script src=https://cdn.jsdelivr.net/npm/algoliasearch@4.14.2/dist/algoliasearch-lite.umd.js integrity="sha256-dImjLPUsG/6p3+i7gVKBiDM8EemJAhQ0VvkRK2pVsQY=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@algolia/autocomplete-js></script><script>function initAutoComplete(){const e=document.createElement("div");e.id="autocomplete";const t=document.createElement("li");t.appendChild(e),document.querySelector("nav.menu > ul")?.prepend(t)}window.onload=()=>{initAutoComplete();const e=algoliasearch("UNAI0RLL8W","59b6ab5b05f94c572e2641c8e61aef71"),{autocomplete:t,getAlgoliaResults:n}=window["@algolia/autocomplete-js"];t({container:"#autocomplete",placeholder:"Search for posts",getSources({query:t}){return[{sourceId:"posts",getItems(){return n({searchClient:e,queries:[{indexName:"algolia",query:t,params:{hitsPerPage:5,attributesToSnippet:["title:10","content:35"],snippetEllipsisText:"…"}}]})},templates:{header({html:e}){return e`
                                    <span class="aa-SourceHeaderTitle"
                                        >Posts</span
                                    >
                                    <div class="aa-SourceHeaderLine" />
                                `},item({item:e,components:n,html:s}){return s`
                                    <a
                                        class="aa-ItemLink"
                                        href="${e.href}?search=${t}"
                                    >
                                        <div class="aa-ItemContent">
                                            <div class="aa-ItemContentBody">
                                                <div
                                                    class="aa-ItemContentTitle"
                                                >
                                                    ${n.Highlight({hit:e,attribute:"title"})}
                                                </div>
                                                <div
                                                    class="aa-ItemContentDescription"
                                                >
                                                    ${n.Snippet({hit:e,attribute:"content"})}
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                `},noResults(){return"No posts for this query."}}}]}})}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"]]}}</script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>Life Log</span>
<span class=logo__cursor></span>
</a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/notes>Notes</a></li><li><a href=/tags>Tags</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/notes>Notes</a></li><li><a href=/tags>Tags</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><article class=post><h1 class=post-title>CSV 파일을 맥용 엑셀에서 볼 때 한글이 깨지는 문제</h1><div class=post-meta><time class=post-date>2025-01-18</time></div><span class=post-tags><a href=https://disj11.github.io/tags/til/>#TIL</a>&nbsp;</span><div class=post-content><h2 id=스프링-부트와-코틀린을-사용한-csv-파일-다운로드-트러블슈팅>스프링 부트와 코틀린을 사용한 CSV 파일 다운로드 트러블슈팅
<a href=#%ec%8a%a4%ed%94%84%eb%a7%81-%eb%b6%80%ed%8a%b8%ec%99%80-%ec%bd%94%ed%8b%80%eb%a6%b0%ec%9d%84-%ec%82%ac%ec%9a%a9%ed%95%9c-csv-%ed%8c%8c%ec%9d%bc-%eb%8b%a4%ec%9a%b4%eb%a1%9c%eb%93%9c-%ed%8a%b8%eb%9f%ac%eb%b8%94%ec%8a%88%ed%8c%85 class=h-anchor aria-hidden=true>#</a></h2><p>스프링 부트와 코틀린을 사용하여 CSV 파일 다운로드 기능을 구현하는 과정에서 발생한 여러 문제와 그 해결 방법에 대해 설명하겠습니다.</p><h3 id=1-한글-깨짐-문제>1. 한글 깨짐 문제
<a href=#1-%ed%95%9c%ea%b8%80-%ea%b9%a8%ec%a7%90-%eb%ac%b8%ec%a0%9c class=h-anchor aria-hidden=true>#</a></h3><p><strong>문제</strong>: CSV 파일을 다운로드하여 맥용 엑셀에서 열었을 때 한글이 깨지는 현상이 발생했습니다.</p><p><strong>해결</strong>:</p><ul><li>API 서버에서 CSV 파일을 생성할 때 BOM(Byte Order Mark) 문자를 추가했습니다.</li><li>BOM은 UTF-8로 인코딩된 파일의 시작 부분에 추가되는 특수한 문자 시퀀스로, 일부 애플리케이션(특히 Microsoft Excel)이 파일의 인코딩을 올바르게 인식하도록 돕습니다.</li></ul><p><strong>코드 예시</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>val</span> bom = byteArrayOf(<span style=color:#ae81ff>0xEF</span>.toByte(), <span style=color:#ae81ff>0xBB</span>.toByte(), <span style=color:#ae81ff>0xBF</span>.toByte())
</span></span><span style=display:flex><span>outputStream.write(bom)
</span></span><span style=display:flex><span><span style=color:#75715e>// CSV 내용 작성 코드
</span></span></span></code></pre></div><h3 id=2-프론트엔드에서의-다운로드-문제>2. 프론트엔드에서의 다운로드 문제
<a href=#2-%ed%94%84%eb%a1%a0%ed%8a%b8%ec%97%94%eb%93%9c%ec%97%90%ec%84%9c%ec%9d%98-%eb%8b%a4%ec%9a%b4%eb%a1%9c%eb%93%9c-%eb%ac%b8%ec%a0%9c class=h-anchor aria-hidden=true>#</a></h3><p><strong>문제</strong>: API 엔드포인트를 브라우저에 직접 입력하여 다운로드할 때는 문제가 없었지만, 프론트엔드에서 API를 호출하여 다운로드할 때 여전히 파일이 깨지는 현상이 발생했습니다.</p><p><strong>해결</strong>:</p><ul><li>프론트엔드에서 API를 호출할 때, 응답 타입을 &lsquo;blob&rsquo;으로 지정했습니다.</li><li>&lsquo;blob&rsquo; 타입은 이진 데이터를 그대로 받아올 수 있게 해주어, 텍스트 인코딩 문제를 방지합니다.</li></ul><p><strong>코드 예시 (JavaScript)</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/download-csv&#39;</span>, {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>responseType</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;blob&#39;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>response</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 파일 다운로드 로직
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>})
</span></span></code></pre></div><h3 id=3-csv-형식-오류>3. CSV 형식 오류
<a href=#3-csv-%ed%98%95%ec%8b%9d-%ec%98%a4%eb%a5%98 class=h-anchor aria-hidden=true>#</a></h3><p><strong>문제</strong>: CSV 데이터에 큰따옴표(<code>"</code>)나 쉼표(<code>,</code>)가 포함된 경우 필드가 밀리는 문제가 발생했습니다.</p><p><strong>해결</strong>:</p><ul><li>필드에 쉼표, 큰따옴표, 개행 문자가 포함된 경우, 해당 필드 전체를 큰따옴표로 감쌌습니다.</li><li>필드 내의 큰따옴표는 두 번 연속 사용하여 이스케이프 처리했습니다.</li></ul><p>이 해결 방법은 RFC 4180 표준을 참고하여 구현되었습니다. RFC 4180은 CSV 파일 형식에 대한 공식적인 명세를 제공하며, 특수 문자 처리에 대한 가이드라인을 포함하고 있습니다.</p><p>RFC 4180에 따르면:</p><ul><li>필드는 쉼표로 구분됩니다.</li><li>필드에 쉼표, 큰따옴표, 또는 줄바꿈이 포함된 경우 해당 필드를 큰따옴표로 묶어야 합니다.</li><li>필드 내에서 큰따옴표를 사용할 경우, 두 개의 연속된 큰따옴표로 이스케이프 처리해야 합니다.</li></ul><p><strong>코드 예시</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>escapeSpecialCharacters</span>(<span style=color:#66d9ef>field</span>: String): String {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>field</span>.contains(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>) <span style=color:#f92672>||</span> <span style=color:#66d9ef>field</span>.contains(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span>) <span style=color:#f92672>||</span> <span style=color:#66d9ef>field</span>.contains(<span style=color:#e6db74>&#34;,&#34;</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>${field.replace(&#34;\&#34;&#34;, &#34;\&#34;\&#34;&#34;)}</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>field</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// CSV 행 생성 시
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>val</span> csvLine = listOf(field1, field2, field3)
</span></span><span style=display:flex><span>    .map { escapeSpecialCharacters(<span style=color:#66d9ef>it</span>) }
</span></span><span style=display:flex><span>    .joinToString(<span style=color:#e6db74>&#34;,&#34;</span>)
</span></span></code></pre></div><p>이 방식을 적용함으로써 RFC 4180 표준을 준수하고, CSV 파일의 구조적 무결성을 유지할 수 있습니다.</p><p><strong>Apache Commons CSV 사용</strong>:</p><p>또 다른 해결 방법으로 Apache Commons CSV 라이브러리를 사용할 수 있습니다. 이 라이브러리는 CSV 파일 처리를 위한 강력하고 유연한 도구를 제공합니다.</p><p>Apache Commons CSV를 사용하면 특수 문자 처리와 같은 복잡한 로직을 직접 구현할 필요 없이 CSV 파일을 쉽게 읽고 쓸 수 있습니다. 예를 들어:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>CSVPrinter csvPrinter <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CSVPrinter(writer, CSVFormat.<span style=color:#a6e22e>DEFAULT</span>);
</span></span><span style=display:flex><span>csvPrinter.<span style=color:#a6e22e>printRecord</span>(<span style=color:#e6db74>&#34;John Doe&#34;</span>, <span style=color:#e6db74>&#34;30&#34;</span>, <span style=color:#e6db74>&#34;New York, NY&#34;</span>);
</span></span></code></pre></div><p>이 코드는 자동으로 필요한 이스케이프 처리를 수행하여 &ldquo;New York, NY"와 같은 쉼표를 포함한 필드를 올바르게 처리합니다.</p><p>Apache Commons CSV를 사용하면 CSV 형식 오류를 방지하고 표준을 준수하는 CSV 파일을 쉽게 생성할 수 있으며, 특수 문자 처리에 대한 걱정 없이 데이터를 안전하게 다룰 수 있습니다</p><h3 id=결론>결론
<a href=#%ea%b2%b0%eb%a1%a0 class=h-anchor aria-hidden=true>#</a></h3><p>CSV 파일 다운로드 기능 구현 시 다음 사항들을 고려해야 합니다:</p><ol><li>인코딩 문제 해결을 위한 BOM 추가</li><li>프론트엔드에서의 올바른 응답 타입 설정</li><li>CSV 형식에 맞는 특수 문자 처리</li></ol><p>이러한 방법들을 적용함으로써 안정적이고 정확한 CSV 파일 다운로드 기능을 구현할 수 있습니다.</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>다른 게시물 읽기</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://disj11.github.io/mysql-index-and-range-conditions/><span class=button__icon>←</span>
<span class=button__text>MySQL 인덱스, 왜 컬럼 순서가 성능을 좌우할까?</span>
</a></span><span class="button next"><a href=https://disj11.github.io/jetbrains-fleet-kotest/><span class=button__text>JetBrains Fleet에서 Kotest 사용하기</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>Life Log</span>
<span class=logo__cursor></span></a><div class=copyright><span>© 2025 Powered by <a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span><a href=https://github.com/panr/hugo-theme-hello-friend target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>